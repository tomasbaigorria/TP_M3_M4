data_eph_limpio %>%
filter(INGRESO_OCUP_PRINCIPAL < quantile(INGRESO_OCUP_PRINCIPAL, .99)) %>%
filter(CANT_HORAS > 0) %>%
ggplot(aes(x = CANT_HORAS, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method='lm',
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Cantidad de Horas Trabajadas") +
labs(x = "Cantidad de horas trabajadas",
y = "Ingreso por Ocupación Principal")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(tidymodels)
tidymodels_prefer()
library(GGally)
library(gtsummary)
library(gt)
library(lubridate)
library(ggplot2)
library(scales)
library(paletteer)
library(viridis)
library(corrplot)
data_eph <- read_csv("./Data/M34_202103_eph.csv") %>%
rename("ROL_HOGAR" = "CH03") %>%
rename("SEXO" = "CH04") %>%
rename("EDAD" = "CH06") %>%
rename("ESTADO CONYUGAL" = "CH07") %>%
rename("SECTOR_PUB_PRIV" = "PP04A") %>%
rename("CANT_HORAS" = "PP3E_TOT") %>%
rename("INGRESO_OCUP_PRINCIPAL" = "P21") %>%
select(3:15) %>%
relocate(INGRESO_OCUP_PRINCIPAL)
top10ingresos <- top_n(data_eph %>% select(INGRESO_OCUP_PRINCIPAL), 10) %>%
arrange(desc(INGRESO_OCUP_PRINCIPAL))
data_eph_limpio <- data_eph %>% filter(INGRESO_OCUP_PRINCIPAL > 0) %>%
filter(INGRESO_OCUP_PRINCIPAL < quantile(INGRESO_OCUP_PRINCIPAL, .99))
data_eph_limpio %>%
select(INGRESO_OCUP_PRINCIPAL) %>%
ggplot(aes(x = INGRESO_OCUP_PRINCIPAL)) +
geom_density(alpha = 0.4, fill = "lightblue") +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Distribución Ingreso por Ocupación Principal") +
labs(x = "Ingreso por Ocupación Principal",
y = "Densidad")
#notese la tendencia en los encuestados a decir un valor redondo para el ignreso
data_eph_limpio %>%
group_by(NIVEL_ED) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(NIVEL_ED = fct_inorder(NIVEL_ED)) %>%
ggplot(aes(x = NIVEL_ED, y = ingreso_promedio, fill = NIVEL_ED)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Nivel Educativo") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
max(data_eph_limpio$CANT_HORAS)
data_eph_limpio <- data_eph_limpio %>%
filter(CANT_HORAS < 168)
data_eph_limpio %>%
filter(INGRESO_OCUP_PRINCIPAL < quantile(INGRESO_OCUP_PRINCIPAL, .99)) %>%
filter(CANT_HORAS > 0) %>%
ggplot(aes(x = CANT_HORAS, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method='lm',
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Cantidad de Horas Trabajadas") +
labs(x = "Cantidad de horas trabajadas",
y = "Ingreso por Ocupación Principal")
View(data_eph_limpio)
data_eph_limpio %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method='lm',
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
?geom_smooth
data_eph_limpio %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 65) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 65) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 60) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 60) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL, fill = SEXO)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 60) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point(aes(fill = SEXO)) +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 60) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point(aes(color = SEXO)) +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>% filter(EDAD < 60) %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
geom_smooth(
method = "lm",
se = FALSE,
color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
ggplot(aes(x = EDAD, y = INGRESO_OCUP_PRINCIPAL)) +
#geom_smooth(
#method = "lm",
#se = FALSE,
#color = 'red') +
geom_point() +
theme_minimal() +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
ggtitle("Ingreso por Ocupación Principal y Edad") +
labs(x = "Edad",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Nivel Educativo") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Nivel Educativo") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
unique(AGLOMERADO)
unique(data_eph_limpio$AGLOMERADO)
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Aglomerado",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(20)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Aglomerado",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = AGLOMERADO, y = ingreso_promedio, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Aglomerado",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = ingreso_promedio, y = AGLOMERADO, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(20)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Aglomerado",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = ingreso_promedio, y = AGLOMERADO, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Aglomerado",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(NIVEL_ED) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(NIVEL_ED = fct_inorder(NIVEL_ED)) %>%
ggplot(aes(x = NIVEL_ED, y = ingreso_promedio, fill = NIVEL_ED)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "A") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso por Ocupación Principal según Nivel Educativo") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = ingreso_promedio, y = AGLOMERADO, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(SEXO)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = ingreso_promedio, y = SEXO, fill = SEXO)) +
geom_col() +
theme_minimal() +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = ingreso_promedio, y = SEXO, fill = SEXO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = SEXO, y = ingreso_promedio, fill = SEXO)) +
geom_col() +
theme_minimal() +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = SEXO, y = ingreso_promedio, fill = SEXO)) +
geom_col() +
theme_minimal() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = SEXO, y = ingreso_promedio, fill = SEXO)) +
geom_col(width = 0.6) +
theme_minimal() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = SEXO, y = ingreso_promedio, fill = SEXO)) +
geom_col(width = 0.5) +
theme_minimal() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = ingreso_promedio, y = AGLOMERADO, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso por Ocupación Principal promedio según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(AGLOMERADO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(AGLOMERADO = fct_inorder(AGLOMERADO)) %>%
ggplot(aes(x = ingreso_promedio, y = AGLOMERADO, fill = AGLOMERADO)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "B") +
guides(fill = "none") +
scale_x_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_y_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso promedio por Ocupación Principal según Aglomerado") +
labs(x = "Ingreso por Ocupación Principal",
y = "Aglomerado")
data_eph_limpio %>%
group_by(SEXO) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(SEXO = fct_inorder(SEXO)) %>%
ggplot(aes(x = SEXO, y = ingreso_promedio, fill = SEXO)) +
geom_col(width = 0.5) +
theme_minimal() +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(100)) +
ggtitle("Ingreso promedio por Ocupación Principal según Sexo") +
labs(x = "Sexo",
y = "Ingreso por Ocupación Principal")
data_eph_limpio %>%
group_by(NIVEL_ED) %>%
summarise(ingreso_promedio = mean(INGRESO_OCUP_PRINCIPAL)) %>%
arrange(ingreso_promedio) %>%
mutate(NIVEL_ED = fct_inorder(NIVEL_ED)) %>%
ggplot(aes(x = NIVEL_ED, y = ingreso_promedio, fill = NIVEL_ED)) +
geom_col() +
theme_minimal() +
scale_fill_viridis_d(option = "A") +
guides(fill = "none") +
scale_y_continuous(labels = comma_format(big.mark = ".", decimal.mark = ",")) +
scale_x_discrete(labels = label_wrap(10)) +
ggtitle("Ingreso promedio por Ocupación Principal según Nivel Educativo") +
labs(x = "Nivel Educativo",
y = "Ingreso por Ocupación Principal")
